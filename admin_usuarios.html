<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Usuarios</title>
    <link rel="stylesheet" href="css/menu_adm.css">
    <link rel="stylesheet" href="css/usuarios.css">
</head>
<body>
  <header>
    <nav class="sidebar">
      <h2><img src="img/logo.png" alt="logo" width="150" height="150"> </h2>
      <ul>
        <li><a href="menu_admin.html">Inicio</a></li>
        <li><a href="admin_animales.html">Animales</a></li>
        <li><a href="admin_usuarios.html">Usuarios</a></li>
      </ul>
      <hr>
      <ul>
        <li><a href="menu.html">Cerrar Sesión</a></li>
      </ul>
    </nav>
  </header>

  <main class="contenido">
    <h1>Gestión de Usuarios</h1>
    <p>Aquí puedes administrar a los usuarios</p>

    <!-- Botón para agregar un nuevo usuario -->
    <button onclick="abrirModal('modalAgregarUsuario')">Agregar Usuario</button>

    <!-- Tabla para mostrar los usuarios -->
    <table id="tablaUsuarios">
        <thead>
            <tr>
                <th>RUT</th>
                <th>Nombre Completo</th>
                <th>Correo</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            <!-- Aquí se llenarán los usuarios dinámicamente -->
        </tbody>
    </table>

    <!-- Modal para agregar usuarios -->
    <div id="modalAgregarUsuario" class="modal">
        <h2>Agregar Usuario</h2>
        <form id="formAgregarUsuario">
            <label for="rut">RUT:</label>
            <input type="text" id="rut" placeholder="Ingrese el RUT" required><br>
            <label for="nombre">Nombre Completo:</label>
            <input type="text" id="nombre" placeholder="Ingrese el nombre completo" required><br>
            <label for="correo">Correo:</label>
            <input type="email" id="correo" placeholder="Ingrese el correo" required><br>
            <label for="contraseña">Contraseña:</label>
            <input type="password" id="contraseña" placeholder="Ingrese la contraseña" required><br>
            <label for="repetirContraseña">Repetir Contraseña:</label>
            <input type="password" id="repetirContraseña" placeholder="Repita la contraseña" required><br>
            <button type="button" onclick="cerrarModal('modalAgregarUsuario')">Cancelar</button>
            <button type="submit">Guardar</button>
        </form>
    </div>

    <!-- Modal para editar usuarios -->
    <div id="modalEditarUsuario" class="modal">
        <h2>Editar Usuario</h2>
        <form id="formEditarUsuario">
            <input type="hidden" id="editarId">
            <label for="editarRut">RUT:</label>
            <input type="text" id="editarRut" required><br>
            <label for="editarNombre">Nombre Completo:</label>
            <input type="text" id="editarNombre" required><br>
            <label for="editarCorreo">Correo:</label>
            <input type="email" id="editarCorreo" required><br>
            <label for="editarContraseña">Contraseña:</label>
            <input type="password" id="editarContraseña" required><br>
            <label for="editarRepetirContraseña">Repetir Contraseña:</label>
            <input type="password" id="editarRepetirContraseña" required><br>
            <button type="button" onclick="cerrarModal('modalEditarUsuario')">Cancelar</button>
            <button type="submit">Guardar</button>
        </form>
    </div>

    <!-- Fondo oscuro -->
    <div id="fondoOscuro" class="fondo-oscuro"></div>
  </main>

  <script>
      // Datos de prueba
      let usuarios = [
          { id: 1, rut: "11.111.111-1", nombre: "Juan Pérez", correo: "juanperez@mail.com", contraseña: "1234", repetirContraseña: "1234" },
          { id: 2, rut: "22.222.222-2", nombre: "María López", correo: "marialopez@mail.com", contraseña: "abcd", repetirContraseña: "abcd" },
          { id: 3, rut: "33.333.333-3", nombre: "Carlos Díaz", correo: "carlosdiaz@mail.com", contraseña: "5678", repetirContraseña: "5678" },
          { id: 4, rut: "44.444.444-4", nombre: "Ana Torres", correo: "anatorres@mail.com", contraseña: "efgh", repetirContraseña: "efgh" },
          { id: 5, rut: "55.555.555-5", nombre: "Luis Gómez", correo: "luisgomez@mail.com", contraseña: "91011", repetirContraseña: "91011" }
      ];

      // Función para mostrar los usuarios en la tabla
      function mostrarUsuarios() {
          const tabla = document.querySelector("#tablaUsuarios tbody");
          tabla.innerHTML = ""; // Limpia la tabla

          usuarios.forEach((usuario, index) => {
              const fila = `
                  <tr>
                      <td>${usuario.rut}</td>
                      <td>${usuario.nombre}</td>
                      <td>${usuario.correo}</td>
                      <td>
                          <button onclick="abrirModalEditar(${index})">Editar</button>
                      </td>
                  </tr>
              `;
              tabla.innerHTML += fila;
          });
      }

      // Función para abrir un modal
      function abrirModal(idModal) {
          document.getElementById(idModal).classList.add('active');
          document.getElementById('fondoOscuro').classList.add('active');
      }

      // Función para cerrar un modal
      function cerrarModal(idModal) {
          document.getElementById(idModal).classList.remove('active');
          document.getElementById('fondoOscuro').classList.remove('active');
      }

      // Función para agregar un nuevo usuario
      document.getElementById("formAgregarUsuario").addEventListener("submit", function (e) {
          e.preventDefault();
          const nuevoUsuario = {
              id: usuarios.length + 1,
              rut: document.getElementById("rut").value,
              nombre: document.getElementById("nombre").value,
              correo: document.getElementById("correo").value,
              contraseña: document.getElementById("contraseña").value,
              repetirContraseña: document.getElementById("repetirContraseña").value
          };
          usuarios.push(nuevoUsuario);
          cerrarModal("modalAgregarUsuario");
          mostrarUsuarios();
      });

      // Función para abrir el modal de edición con los datos del usuario
      function abrirModalEditar(index) {
          const usuario = usuarios[index];
          document.getElementById("editarId").value = index;
          document.getElementById("editarRut").value = usuario.rut;
          document.getElementById("editarNombre").value = usuario.nombre;
          document.getElementById("editarCorreo").value = usuario.correo;
          document.getElementById("editarContraseña").value = usuario.contraseña;
          document.getElementById("editarRepetirContraseña").value = usuario.repetirContraseña;
          abrirModal("modalEditarUsuario");
      }

      // Función para guardar los cambios al editar un usuario
      document.getElementById("formEditarUsuario").addEventListener("submit", function (e) {
          e.preventDefault();
          const index = document.getElementById("editarId").value;
          usuarios[index] = {
              id: usuarios[index].id,
              rut: document.getElementById("editarRut").value,
              nombre: document.getElementById("editarNombre").value,
              correo: document.getElementById("editarCorreo").value,
              contraseña: document.getElementById("editarContraseña").value,
              repetirContraseña: document.getElementById("editarRepetirContraseña").value
          };
          cerrarModal("modalEditarUsuario");
          mostrarUsuarios();
      });

      // Mostrar los usuarios al cargar la página
      mostrarUsuarios();
  </script>
</body>
</html>